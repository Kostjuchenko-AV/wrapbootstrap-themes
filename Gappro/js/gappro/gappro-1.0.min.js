$.webshims.polyfill();$("#btn-restore-all").bind("click",function(){$("#workspace .btn").not("#btn-restore-all").each(function(){$(this).trigger("click")})});$(".icon-menu > ul > li > a > i").each(function(){var menuitem=$(this).parent();menuitem.draggable({cursor:"move",revert:"invalid",snap:".navbar-inner form.form-search"})});
$(".navbar-inner form.form-search").droppable({accept:".icon-menu > ul > li > a",activeClass:"menuitem-active",hoverClass:"menuitem-hover",tolerance:"touch",drop:function(event,ui){var menuitem=ui.draggable;add_to_favlinks(menuitem.clone());ui.draggable.draggable("option","revert",true)}});
$(".widget .widget-header > a[data-rel='widget']").each(function(){var action_name=$(this).attr("data-action").trim().toLowerCase();switch(action_name){case "close":$(this).html("<i class='icon-remove'></i>");$(this).bind("click",function(){$(this).parent().parent().slideUp()});break;case "hide":$(this).html("<i class='icon-minus'></i>");$(this).bind("click",function(){$(this).parent().next("div").slideToggle();if($(this).html().trim().toLowerCase()=='<i class="icon-minus"></i>')$(this).html('<i class="icon-plus"></i>');
else $(this).html('<i class="icon-minus"></i>')});break;case "code":$(this).html("<i class='icon-legal'></i>");$(this).bind("click",function(){var html=$(this).parent().parent().parent().html().trim();html=html.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");var id=(new Date).getTime().toString();$('<div id="'+id+'" class="modal hide fade" tabindex="-1" role="dialog"><div class="modal-body"><pre class="prettyprint lang-html linenums"></pre></div></div>').appendTo("body");html=style_html(html,
2," ",80);$("#"+id+" pre.prettyprint").html(html);prettyPrint();$("#"+id).modal();$("#"+id).on("hidden",function(){$(this).remove()})});break;case "config":$(this).html('<i class="icon-cog"></i>');$(this).bind("click",function(){$("#"+$(this).attr("target-box")).modal()});break;case "help":$(this).html('<i class="icon-question-sign"></i>');$(this).bind("click",function(){$("#"+$(this).attr("target-box")).modal()});break;case "thumb":$(this).html('<i class="icon-arrow-left"></i>');$(this).bind("click",
function(){add_to_sidebar($(this).parent().parent(),$(this).parent().find("h3").html())});break;case "full":$(this).html('<i class="icon-fullscreen"></i>');$(this).bind("click",function(){var width=$(window).width();var height=$(window).height();if(!$(this).data("full")){$(this).data("position",$(this).parent().parent().css("position"));$(this).data("left",$(this).parent().parent().css("left"));$(this).data("top",$(this).parent().parent().css("top"));$(this).data("width",$(this).parent().parent().css("width"));
$(this).data("height",$(this).parent().parent().css("height"));$(this).data("background-color",$(this).parent().parent().css("background-color"));$(this).data("z-index",$(this).parent().parent().css("z-index"));$(this).parent().parent().fadeIn().css({"position":"absolute","left":"0px","top":"0px","width":width,"height":height,"background-color":"#272727","z-index":9999});$(this).data("full",true)}else{$(this).parent().parent().css({"position":$(this).data("position"),"left":$(this).data("left"),"top":$(this).data("top"),
"width":$(this).data("width"),"height":$(this).data("height"),"background-color":$(this).data("background-color"),"z-index":$(this).data("z-index")});$(this).data("full",false)}});break}});
$("#btn-menu-controller").bind("click",function(){var display;if($(this).html().trim()=='<span><i class="icon-angle-up"></i></span>'){$(this).html('<span><i class="icon-angle-down"></i></span>');$(this).css({"border-bottom-left-radius":"4px","border-bottom-right-radius":"4px"});display="none"}else{$(this).html('<span><i class="icon-angle-up"></i></span>');display="block"}$(".icon-menu > ul > li:nth-child(n+4)").each(function(){$(this).css("display",display)})});
$("#menuitem-filter").bind("keyup",function(e){var input=$("#menuitem-filter").val().trim().toLowerCase();if(e.keyCode==27){$("#menuitem-filter").val("");input=""}$(".icon-menu > ul > li:nth-child(n+4)").each(function(){if(input.length>0&&($(this).attr("data-keywords")||"").toLowerCase().indexOf(input)==-1&&($(this).find("a > span").html()||"").toLowerCase().indexOf(input)==-1)display="none";else display="block";$(this).css("display",display)})});var global_hover=null;
$(".icon-menu > ul > li > a").each(function(){$(this).bind("click",function(e){var sidebar_margin=$("#main_wrapper").css("margin-left");var sidebar_padding=$("#main_wrapper").css("padding-left");var width=$(this).parent().width()*1+sidebar_margin.replace("px","")*1+sidebar_padding.replace("px","")*1;if($("#main_wrapper").width()<=640)width=50;else if($("#main_wrapper").width()<=800)width-=4;$(this).next(".quick-widget, .sub-menus").each(function(){$(this).addClass("sub-hover").css("left",width);if(global_hover&&
global_hover.html()!=$(this).html())global_hover.removeClass("sub-hover");global_hover=$(this)});if($(this).next(".sub-menus, .quick-widget").length>0)e.preventDefault()})});$(".icon-menu").bind("mouseleave",function(e){if(global_hover){var timer=setTimeout(function(){global_hover.removeClass("sub-hover")},1E3);global_hover.bind("mouseenter",function(){clearTimeout(timer)})}});load_fav_menus();$("a[data-toggle=tooltip]").tooltip().click(function(e){e.preventDefault()});$("a[data-toggle=popover]").popover().click(function(e){e.preventDefault()});
function add_to_sidebar(widget,title,pos){var id=widget.attr("id");if($("#workspace").css("display")=="none")return;if(!title)title="Untitled Widget";if(!id||id.length==0){id=(new Date).getTime().toString();widget.attr("id",id)}widget.fadeOut();$.bootstrapGrowl("<img src='img/icons/heart.png' alt='' /> You can restore it from sidebar.",{align:"center"});$("#workspace").append("<a rel='widget-thumb' class='btn' id='thumb"+id+"' target-id='"+id+"' href='javascript:void(0)'><i class='icon-arrow-right'></i> "+
title+"</a>");$("#thumb"+id).bind("click",function(){$("#"+$(this).attr("target-id")).fadeIn();$("html,body").animate({scrollTop:$("#"+$(this).attr("target-id")).offset().top},1E3);$(this).remove()})}
function add_to_favlinks(menuitem){menuitem.attr("id",(new Date).getTime().toString());menuitem.addClass("btn").css({"left":0,"top":0,"margin-right":"4px"});menuitem.draggable({start:function(){$(this).remove();save_fav_menus()}});$.bootstrapGrowl("<img src='img/icons/heart.png' alt='' /> I'm persistent, you can drag again to remove me.",{align:"center"});$(".navbar-inner form.form-search").append(menuitem);var outer_html=$("<div></div>").append(menuitem.clone()).html();var fav_menus_str=$.jStorage.get("fav_menus_str");
if(!fav_menus_str||fav_menus_str.length==0)$.jStorage.set("fav_menus_str",outer_html);else $.jStorage.set("fav_menus_str",fav_menus_str+"@"+outer_html)}function load_fav_menus(){var fav_menus_str=$.jStorage.get("fav_menus_str");if(fav_menus_str&&fav_menus_str.length>0){var array=$.jStorage.get("fav_menus_str").split("@");for(idx in array){var menuitem=$(array[idx]);menuitem.appendTo(".navbar-inner form.form-search");menuitem.draggable({start:function(){$(this).remove();save_fav_menus()}})}}}
function save_fav_menus(){var array=[];$(".navbar-inner form.form-search .ui-draggable").each(function(){var outer_html=$("<div></div>").append($(this).clone()).html();array.push(outer_html)});if(array.length>0)$.jStorage.set("fav_menus_str",array.join("@"));else $.jStorage.deleteKey("fav_menus_str")};